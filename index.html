<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKVED Search</title>
    <style>
        #results {
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <h1>OKVED Live Search</h1>

    <label for="okvedCode">OKVED Code:</label>
    <input type="text" id="okvedCode" name="okvedCode" placeholder="Enter OKVED code (e.g., 01.11.1)" maxlength="9">


    

    <div id="results"></div>

    <script>
        const okvedData = [
  {
    "code": "01",
    "name": "Растениеводство и животноводство, охота и предоставление соответствующих услуг в этих областях",
    "subclasses": [
      {
        "code": "01.1",
        "name": "Выращивание однолетних культур",
        "groups": [
          {
            "code": "01.11",
            "name": "Выращивание зерновых (кроме риса), зернобобовых культур и семян масличных культур",
            "subgroups": [
              {
                "code": "01.11.1",
                "name": "Выращивание зерновых культур",
                "types": [
                    {
                      "code": "01.11.11",
                      "name": "Выращивание пшеницы",
                    },
                    {
                         "code": "01.11.12",
                        "name": "Выращивание ячменя",
                    },
                 ]
              }
            ]
          }
        ]
      }
    ]
  },
    {
    "code": "02",
    "name": "Лесоводство и лесозаготовки",
    "subclasses": [
      {
        "code": "02.1",
        "name": "Лесоводство и прочая деятельность, связанная с лесоводством",
        "groups": [
          {
            "code": "02.10",
            "name": "Лесоводство и прочая деятельность, связанная с лесоводством",
            "subgroups": [
              {
                "code": "02.10.1",
                "name": "Лесоводство",
                "types": [
                    {
                        "code": "02.10.11",
                        "name": "Выращивание посадочного материала лесных растений (саженцев, сеянцев)",
                    }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
];

        function searchOkved(query) {
            const results = [];

            function traverse(data) {
              for (const item of data) {
                // Check if the code starts with the query
                if (item.code.startsWith(query)) {
                  results.push({ code: item.code, name: item.name });
                }
                
                // Check in types
                if (item.types) {
                  for (const type of item.types) {
                    if (type.code.startsWith(query)) {
                      results.push({ code: type.code, name: type.name });
                    }
                  }
                }

                // Recursively check subclasses
                if (item.subclasses) {
                  traverse(item.subclasses);
                }

                // Recursively check groups
                if (item.groups) {
                  traverse(item.groups);
                }
              }
            }

            traverse(okvedData);
            return results;
        }

        function displayResults(results) {
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = "";
          
            if (results.length === 0) {
              resultsDiv.innerHTML = "<p>No results found.</p>";
              return;
            }
          
            const ul = document.createElement("ul");
            results.forEach(result => {
                const li = document.createElement("li");
                li.textContent = `${result.code}: ${result.name}`;
                ul.appendChild(li);
            });
            resultsDiv.appendChild(ul);
        }

        const okvedCodeInput = document.getElementById("okvedCode");

        okvedCodeInput.addEventListener("input", () => {
          const query = okvedCodeInput.value.trim();
          
          if (query.length > 0) {
              const results = searchOkved(query);
              displayResults(results);
          } else {
              // Clear results if the input field is empty
              displayResults([]);
            }
        });

    </script>
</body>
</html>